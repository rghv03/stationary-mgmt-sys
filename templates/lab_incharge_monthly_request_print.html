{% extends 'base.html' %}
{% block title %}Monthly Request Print{% endblock %}
{% block body %}
<div id="print-section">
    <div class="container mt-5">
        <h2>Monthly Stationary Request - {{ req.month }} {{ req.year }}</h2>
        <p><strong>Requested By:</strong> {{ user.first_name }} {{ user.last_name }}, {{ user.department.shortname if user.department else '' }}</p>
        <p><strong>Date:</strong> {{ req.date_requested.strftime('%d-%m-%Y') }}</p>
        <table class="table table-bordered ">
            <thead class="table-dark">
                <tr>
                    <th style="text-align: center;">Sr. No.</th>
                    <th style="text-align: center;">Name of Items</th>
                    <th style="text-align: center;">Quantity Demanded</th>
                    <th style="text-align: center;">Quantity Issued</th>
                    <th style="text-align: center;">Remarks</th>
                </tr>
            </thead>
            <tbody>
                {% for item in req.items %}
                <tr>
                    <td style="text-align: center;">{{ loop.index }}</td>
                    <td style="text-align: center;">{{ item.item }}</td>
                    <td style="text-align: center;">{{ item.quantity }}</td>
                    <td style="text-align: center;">{{ item.quantity_issued if item.quantity_issued is defined else 0 }}</td>
                    <td style="text-align: center;">{{ item.remarks }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <p style="text-align: right;"><br><br>{{ user.first_name }} {{ user.middle_name }} {{ user.last_name }}<br>{{ user.designation }}</p>
        {% if req.lab_incharge_status == 'Issued' %}
            <div class="col text-start">
                <strong>AD/Head</strong><br>
                <strong>{{ user.department.shortname }}</strong>
            </div>
        {% endif %}
    </div>
</div>
<button type="button" onclick="printTable()" class="btn btn-primary mt-3 w-25" style="margin-left: 35%;" ><strong>Print</strong></button>
<script>
    var bootstrapCss = "{{url_for('static', filename='css/bootstrap.min.css') }}";
</script>
<script>
    function printTable(){
        var printContents = document.getElementById('print-section').innerHTML;
        var win = window.open('', '', 'height=700,width=900');
        win.document.write('<html><head><title>Print</title>');
        win.document.write('<link rel="stylesheet" href="{{url_for("static", filename="css/bootstrap.min.css") }}">');
        win.document.write('</head><body>');
        win.document.write(printContents);
        win.document.write('</body></html>');
        win.document.close();
        win.focus();
        win.print();
}
</script>
{% endblock %} 